# server/akkadian_symbols.py

# æ‰©å……åçš„é˜¿å¡å¾·éŸ³èŠ‚æ˜ å°„è¡¨
SYLLABARY = {
    # çº¯å…ƒéŸ³
    "a": "ğ’€€", "e": "ğ’‚Š", "i": "ğ’„¿", "u": "ğ’Œ‹",
    
    # S-ç³»åˆ—
    "sha": "ğ’Š­", "she": "ğ’Šº", "shi": "ğ’…†", "shu": "ğ’‹—",
    "sa": "ğ’Š“", "si": "ğ’‹›", "su": "ğ’‹¢",
    
    # R-ç³»åˆ—
    "ra": "ğ’Š", "re": "ğ’Š‘", "ri": "ğ’Š‘", "ru": "ğ’Š’",
    "ar": "ğ’…ˆ", "er": "ğ’…•", "ir": "ğ’…•", "ur": "ğ’Œ¨",
    
    # M-ç³»åˆ—
    "ma": "ğ’ˆ ", "me": "ğ’ˆ¨", "mi": "ğ’ˆª", "mu": "ğ’ˆ¬",
    "am": "ğ’„ ", "em": "ğ’…", "im": "ğ’…", "um": "ğ’Œ",
    
    # N-ç³»åˆ—
    "na": "ğ’ˆ¾", "ne": "ğ’‰ˆ", "ni": "ğ’‰Œ", "nu": "ğ’‰¡",
    "an": "ğ’€­", "en": "ğ’‚—", "in": "ğ’…”", "un": "ğ’Œ¦",
    
    # B/P-ç³»åˆ—
    "ba": "ğ’€", "be": "ğ’", "bi": "ğ’‰", "bu": "ğ’",
    "pa": "ğ’‰º", "pe": "ğ’‰", "pi": "ğ’‰", "pu": "ğ’",
    "ab": "ğ’€Š", "ib": "ğ’…", "ub": "ğ’Œ’",
    
    # D/T-ç³»åˆ—
    "da": "ğ’•", "de": "ğ’²", "di": "ğ’²", "du": "ğ’º",
    "ta": "ğ’‹«", "te": "ğ’‹¼", "ti": "ğ’‹¾", "tu": "ğ’Œ…",
    "ad": "ğ’€œ", "ed": "ğ’€‰", "id": "ğ’€‰", "ud": "ğ’Œ“",
    
    # K/G/Q-ç³»åˆ—
    "ka": "ğ’…—", "ke": "ğ’† ", "ki": "ğ’† ", "ku": "ğ’†ª",
    "ga": "ğ’‚µ", "ge": "ğ’„€", "gi": "ğ’„€", "gu": "ğ’„–",
    "ak": "ğ’€", "ik": "ğ’……", "uk": "ğ’ŠŒ",
    
    # L-ç³»åˆ—
    "la": "ğ’†·", "le": "ğ’‡·", "li": "ğ’‡·", "lu": "ğ’‡»",
    "al": "ğ’€ ", "il": "ğ’…‹", "ul": "ğ’ŒŒ",
    
    # Z-ç³»åˆ—
    "za": "ğ’", "ze": "ğ’¢", "zi": "ğ’¢", "zu": "ğ’ª"
}

def to_cuneiform(text):
    """
    å°†æ‹‰ä¸è½¬å†™æ–‡æœ¬è½¬æ¢ä¸ºæ¥”å½¢æ–‡å­—ã€‚
    é€»è¾‘ï¼šæœ€é•¿åŒ¹é…åŸåˆ™ï¼Œå¹¶å¯¹æ— æ³•è¯†åˆ«çš„éƒ¨åˆ†ä½¿ç”¨è€ƒå¤å ä½ç¬¦ [...]
    """
    if not text:
        return "..."
        
    # é¢„å¤„ç†ï¼šè½¬å°å†™ï¼Œç§»é™¤è¿å­—ç¬¦ï¼Œå¤„ç†ç©ºæ ¼
    text = text.lower().replace("-", "").strip()
    result = []
    i = 0
    unknown_active = False # æ ‡è®°å½“å‰æ˜¯å¦æ­£å¤„äºâ€œæ— æ³•è¯†åˆ«â€çŠ¶æ€
    
    while i < len(text):
        found = False
        
        # è·³è¿‡ç©ºæ ¼ä½†é‡ç½®æœªçŸ¥æ ‡è®°
        if text[i] == " ":
            result.append("  ") # ä¿æŒé—´è·
            unknown_active = False
            i += 1
            continue

        # å°è¯•åŒ¹é… 3, 2, 1 é•¿åº¦çš„éŸ³èŠ‚
        for length in [3, 2, 1]:
            if i + length <= len(text):
                substring = text[i : i + length]
                if substring in SYLLABARY:
                    result.append(SYLLABARY[substring])
                    i += length
                    found = True
                    unknown_active = False # åŒ¹é…æˆåŠŸï¼Œå…³é—­æœªçŸ¥çŠ¶æ€
                    break
        
        # å¦‚æœæ‰€æœ‰é•¿åº¦éƒ½åŒ¹é…å¤±è´¥
        if not found:
            if not unknown_active:
                # ç¬¬ä¸€æ¬¡é‡åˆ°æ— æ³•åŒ¹é…çš„å­—ç¬¦ï¼Œæ·»åŠ è€ƒå¤ä¿®å¤ç¬¦
                result.append("...") 
                unknown_active = True # è¿›å…¥æŒç»­æœªçŸ¥çŠ¶æ€ï¼Œåç»­è¿ç»­å¤±è´¥å°†ä¸å†æ·»åŠ ç¬¦å·
            i += 1
            
    return "".join(result)